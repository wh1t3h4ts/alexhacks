{% extends 'base.html' %}
{% block content %}
<div class="max-w-md mx-auto">
  <div class="bg-gray-800 p-8 rounded-2xl shadow-lg animate-fade-in">
    <div class="flex mb-6">
      <button id="login-tab" class="flex-1 py-2 px-4 text-center text-white bg-gray-700 rounded-l-xl">Login</button>
      <button id="register-tab" class="flex-1 py-2 px-4 text-center text-gray-400 bg-gray-600 rounded-r-xl">Sign Up</button>
    </div>

    <form id="login-form" method="post" action="{% url 'portal:login' %}">
      {% csrf_token %}
      <div class="mb-4">
        <label class="block text-gray-400 mb-2">Email</label>
        <input type="email" name="email" id="login-email" class="w-full p-3 bg-gray-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
        <p id="login-email-error" class="text-red-400 text-sm mt-1 hidden">Please enter a valid email</p>
      </div>
      <div class="mb-6">
        <label class="block text-gray-400 mb-2">Password</label>
        <input type="password" name="password" id="login-password" class="w-full p-3 bg-gray-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
        <p id="login-password-error" class="text-red-400 text-sm mt-1 hidden">Password is required</p>
      </div>
      <button type="submit" class="w-full bg-gray-700 text-white py-3 rounded-xl hover:bg-gray-600 transition-all duration-300">Login</button>
    </form>

    <form id="register-form" method="post" action="{% url 'portal:register' %}" class="hidden">
      {% csrf_token %}
      <div class="mb-4">
        <label class="block text-gray-400 mb-2">Email</label>
        <input type="email" name="email" id="register-email" class="w-full p-3 bg-gray-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
        <p id="register-email-error" class="text-red-400 text-sm mt-1 hidden">Please enter a valid email</p>
      </div>
      <div class="mb-4">
        <label class="block text-gray-400 mb-2">Phone</label>
        <input type="tel" name="phone" id="register-phone" class="w-full p-3 bg-gray-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
        <p id="register-phone-error" class="text-red-400 text-sm mt-1 hidden">Please enter a valid phone number</p>
      </div>
      <div class="mb-6">
        <label class="block text-gray-400 mb-2">Password</label>
        <input type="password" name="password" id="register-password" class="w-full p-3 bg-gray-700 text-white rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
        <p id="register-password-error" class="text-red-400 text-sm mt-1 hidden">Password must be at least 6 characters</p>
      </div>
      <button type="submit" class="w-full bg-gray-700 text-white py-3 rounded-xl hover:bg-gray-600 transition-all duration-300">Sign Up</button>
    </form>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const loginTab = document.getElementById('login-tab');
    const registerTab = document.getElementById('register-tab');
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');

    loginTab.addEventListener('click', function() {
      loginTab.classList.add('bg-gray-700', 'text-white');
      loginTab.classList.remove('text-gray-400', 'bg-gray-600');
      registerTab.classList.remove('bg-gray-700', 'text-white');
      registerTab.classList.add('text-gray-400', 'bg-gray-600');
      loginForm.classList.remove('hidden');
      registerForm.classList.add('hidden');
    });

    registerTab.addEventListener('click', function() {
      registerTab.classList.add('bg-gray-700', 'text-white');
      registerTab.classList.remove('text-gray-400', 'bg-gray-600');
      loginTab.classList.remove('bg-gray-700', 'text-white');
      loginTab.classList.add('text-gray-400', 'bg-gray-600');
      registerForm.classList.remove('hidden');
      loginForm.classList.add('hidden');
    });

    // Form validation
    loginForm.addEventListener('submit', function(e) {
      const email = document.getElementById('login-email');
      const password = document.getElementById('login-password');
      let valid = true;

      if (!email.checkValidity()) {
        document.getElementById('login-email-error').classList.remove('hidden');
        valid = false;
      } else {
        document.getElementById('login-email-error').classList.add('hidden');
      }

      if (!password.value) {
        document.getElementById('login-password-error').classList.remove('hidden');
        valid = false;
      } else {
        document.getElementById('login-password-error').classList.add('hidden');
      }

      if (!valid) e.preventDefault();
    });

    registerForm.addEventListener('submit', function(e) {
      const email = document.getElementById('register-email');
      const phone = document.getElementById('register-phone');
      const password = document.getElementById('register-password');
      let valid = true;

      if (!email.checkValidity()) {
        document.getElementById('register-email-error').classList.remove('hidden');
        valid = false;
      } else {
        document.getElementById('register-email-error').classList.add('hidden');
      }

      if (!phone.checkValidity()) {
        document.getElementById('register-phone-error').classList.remove('hidden');
        valid = false;
      } else {
        document.getElementById('register-phone-error').classList.add('hidden');
      }

      if (password.value.length < 6) {
        document.getElementById('register-password-error').classList.remove('hidden');
        valid = false;
      } else {
        document.getElementById('register-password-error').classList.add('hidden');
      }

      if (!valid) e.preventDefault();
    });
  });
</script>
{% endblock %}
